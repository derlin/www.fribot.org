window.wp=window.wp||{},function(o){var t,i=wp.customize;o.extend(o.support,{history:!(!window.history||!history.pushState),hashchange:"onhashchange"in window&&(void 0===document.documentMode||7<document.documentMode)}),t=o.extend({},i.Events,{initialize:function(){this.body=o(document.body),t.settings&&o.support.postMessage&&(o.support.cors||!t.settings.isCrossDomain)&&(this.window=o(window),this.element=o('<div id="customize-container" />').appendTo(this.body),this.bind("open",this.overlay.show),this.bind("close",this.overlay.hide),o("#wpbody").on("click",".load-customize",function(e){e.preventDefault(),t.link=o(this),t.open(t.link.attr("href"))}),o.support.history&&this.window.on("popstate",t.popstate),o.support.hashchange&&(this.window.on("hashchange",t.hashchange),this.window.triggerHandler("hashchange")))},popstate:function(e){e=e.originalEvent.state;e&&e.customize?t.open(e.customize):t.active&&t.close()},hashchange:function(){var e=window.location.toString().split("#")[1];e&&0===e.indexOf("wp_customize=on")&&t.open(t.settings.url+"?"+e),e||o.support.history||t.close()},beforeunload:function(){if(!t.saved())return t.settings.l10n.saveAlert},open:function(e){if(!this.active){if(t.settings.browser.mobile)return window.location=e;this.active=!0,this.body.addClass("customize-loading"),this.saved=new i.Value(!0),this.iframe=o("<iframe />",{src:e}).appendTo(this.element),this.iframe.one("load",this.loaded),this.messenger=new i.Messenger({url:e,channel:"loader",targetWindow:this.iframe[0].contentWindow}),this.messenger.bind("ready",function(){t.messenger.send("back")}),this.messenger.bind("close",function(){o.support.history?history.back():o.support.hashchange?window.location.hash="":t.close()}),o(window).on("beforeunload",this.beforeunload),this.messenger.bind("activated",function(e){e&&(window.location=e)}),this.messenger.bind("saved",function(){t.saved(!0)}),this.messenger.bind("change",function(){t.saved(!1)}),this.pushState(e),this.trigger("open")}},pushState:function(e){var t;o.support.history&&window.location.href!==e?history.pushState({customize:e},"",e):!o.support.history&&o.support.hashchange&&t&&(t=e.split("?")[1],window.location.hash="wp_customize=on&"+t)},opened:function(){t.body.addClass("customize-active full-overlay-active")},close:function(){this.active&&(this.saved()||confirm(t.settings.l10n.saveAlert)?(this.active=!1,this.trigger("close"),this.link&&this.link.focus()):history.forward())},closed:function(){t.iframe.remove(),t.messenger.destroy(),t.iframe=null,t.messenger=null,t.saved=null,t.body.removeClass("customize-active full-overlay-active").removeClass("customize-loading"),o(window).off("beforeunload",t.beforeunload)},loaded:function(){t.body.removeClass("customize-loading")},overlay:{show:function(){this.element.fadeIn(200,t.opened)},hide:function(){this.element.fadeOut(200,t.closed)}}}),o(function(){t.settings=_wpCustomizeLoaderSettings,t.initialize()}),i.Loader=t}((wp,jQuery));